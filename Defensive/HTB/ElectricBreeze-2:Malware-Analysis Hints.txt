--Introduction--
Your boss is concerned about Volt Typhoon and some of their malware developments. He has requested that you obtain a copy of the associated malware and conduct a static analysis to identify any useful information. 
Please report back with your findings.

1. Use MalwareBazaar to download a copy of the file with the hash '4bcedac20a75e8f8833f4725adfc87577c32990c3783bf6c743f14599a176c37'. What is the URL to do this?
	Go to https://bazaar.abuse.ch/browse/, hover over search syntax. This is too long to be an MD5, so try SHA256:[hash]. 
  The first result tags line up with Volt Typoon, and there versa hack, download, and the link is the answer
	
2. What is the password to unlock the zip?
	It is mentioned on the download page
	
3. What is the extension of the file once unzipping?
	Unzip with your preferred archiving tool, and enter the password. It gives you a different archive format, which is the answer
	
4. What is a suspicious directory in META-INF?
	After extracting the second archive, you will have a number of directories. 
  If you look around, you will find a folder named x_tomcat_memShell, which is suspicious in general, but especially in the context of the exploit.
	
5. One of the files in this directory may give some insight into the threat actor's origin. What is the file?
	One file is basically useless; the other one has a comment in a foreign language

6. According to Google Translate, what language is the suspicious text?
	Chinese

7. What is the translation in English?
	https://www.deepl.com/en/translator/l/zh/en, regular Google Translate didn't translate the same way as htb expected
	
8. According to this file, what is the application's name?
	In the same file as before, look at the finalname or name parameters

9. The VersaMem web shell works by hooking Tomcat. Which file holds the functionality to accomplish this?
	decode all the class files into Java bytecode with "javap -c -v [class file] > [output file]", you will notice one file uses pgrep and then specifically targets Apache files, so it is the answer
	
10. There is a command that determines the PID for the hook. What is the program used in this line of code?
	Very few Linux commands do that, but I mentioned the exact one above

11. The functionality for the webshell is in a different file. What is its name?
	This file is located in the same directory, and it mentions "shell" multiple times.

12. What is the name of the function that deals with authentication into the webshell?
	Look at the code around the calls to the function that creates the webshell

13. What request parameter must be present to activate the webshell logic?
14. What is the hardcoded access password used to validate incoming webshell requests?
15. What type of encryption is used?
16. What cipher mode is used to encrypt the credentials?
17. What is the key?
	There is a very long string that controls the webshell logic. I recommend formatting it in another file, as you will be searching through it a lot

18. What is the value of the key after decoding?
	Research the AES format. Currently, you have decimals, and you want to end up with text.

19. To avoid static detection, the method name is constructed at runtime and passed to java.lang.reflect.Method, what is the decimal byte array used to construct the string name?
20. What is the Base64-encoded string that is returned to the client if the class is successfully defined?
	Look in the string mentioned in #13
	
21. What is the decrypted string?
	Use the encoded string and previously found key with a tool like https://www.devglan.com/online-tools/aes-encryption-decryption
	
22. There is another class to log passwords for exfiltration. What is this file?
	It's in the init directory, and the filename is very obvious.
	
23. What is the main malicious function in this class?
	There are 2 malicious functions in the main class, one is just worse

24. The same AES key from the previous method is being used. What is the variable name it is being saved as in this function?
	Similar to 13-21, there is a single main string that serves as the core logic of the malicious function. Find it, then look for where the previously found key is, and see what the variable is called
	
25. What file is used to hold credentials before exfiltration?
	In the same string as for 24, you will see a bunch of log code in the end of the string, the log location is hardcoded there aswell in the format /***/.****.****
